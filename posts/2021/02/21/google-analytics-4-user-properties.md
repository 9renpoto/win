---
date: '2021-02-21T16:30:00+09:00'
title: GA4でユーザープロパティを使う
---

# TL;DR

- GTMより配信したGA4でユーザープロパティを使うには **初期 `pageview`
  送信前までにデータを入れる**

## GTMから使う場合

1. GTM初期化前にユーザープロパティ等で使いたい変数をpageview送信前に入れる
   - GA4より `pageview`
     はイベントとして、かつ特に設定なくデフォルト設定では自動的に送信される
   - 自動で送信というのがいつなのかわからないので最速であるGTM初期化前に必要なデータを集める必要がある
1. `dataLayer` 変数をGTMに設定する
   - 管理画面上からポチポチする必要がある
   - これをやらないとGA4から対象として認識さない
1. GTMデバッグモードとGA4デバッグビューを使ってリアルタイムに結合確認をする

## dataLayer変数って更新されない？

- dataLayer変数を経由して更新可能な変数がセットできる？ようにドキュメントに書いている用に見えるがユーザープロパティでは1回しか更新されない？
- カスタムディメンションにデータレイヤー経由で設定できない？うまく動かせてないので要調査
